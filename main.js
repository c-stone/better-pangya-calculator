const shotData = {
  "tomahawk": {
    "1w": {
      "eleEffectPos": 0.63,
      "eleEffectNeg": 0.592,
      "eleVarPos": 1.011,
      "eleVarNeg": 1.011,
      "eleInfPos": 2.7,
      "eleInfNeg": 4.25,
      "eleWindFactPos": 1,
      "eleWindFactNeg": 1.25,
      "windFactorPos": 3,
      "windFactorNeg": 6.25,
      "windDistFactPos": 0.016,
      "windDistFactNeg": 0.015,
      "xSquared": 0.0000396,
      "xTerm": -0.0141,
      "constant": 1.64,
      "distArray": [
        248.12, 280.6, 315.25
      ],
      "powerArray": [80, 90, 100]

    },
    "2w": {
      "eleEffectPos": 0.575,
      "eleEffectNeg": 0.535,
      "eleVarPos": 1.011,
      "eleVarNeg": 1.011,
      "eleInfPos": 2.7,
      "eleInfNeg": 4.25,
      "eleWindFactPos": 1,
      "eleWindFactNeg": 1.23,
      "windFactorPos": 3.2,
      "windFactorNeg": 6.25,
      "windDistFactPos": 0.016,
      "windDistFactNeg": 0.015,
      "xSquared": 0.0000412,
      "xTerm": -0.00946,
      "constant": 0.849,
      "distArray": [
        238.7, 268.4, 299.2
      ],
      "powerArray": [80, 90, 100]
    }
    "3w": {
      "eleEffectPos": 0.575,
      "eleEffectNeg": 0.535,
      "eleVarPos": 1.011,
      "eleVarNeg": 1.011,
      "eleInfPos": 2.7,
      "eleInfNeg": 4.25,
      "eleWindFactPos": 1,
      "eleWindFactNeg": 1.23,
      "windFactorPos": 3.2,
      "windFactorNeg": 6.25,
      "windDistFactPos": 0.016,
      "windDistFactNeg": 0.015,
      "xSquared": 0.0000412,
      "xTerm": -0.00946,
      "constant": 0.849,
      "distArray": [
        227.7, 255.2, 283.15
      ],
      "powerArray": [80, 90, 100]
    }
  },
  "backspin": {
    "1w": {
      "eleEffectPos": 0.755,
      "eleEffectNeg": 0.65,
      "eleVarPos": 1.012,
      "eleVarNeg": 1.013,
      "eleInfPos": 2.7,
      "eleInfNeg": 2.95,
      "eleWindFactPos": 1,
      "eleWindFactNeg": 1.28,
      "windFactorPos": 4,
      "windFactorNeg": 5.6,
      "windDistFactPos": 0.017,
      "windDistFactNeg": 0.019,
      "xSquared": 0.0000502,
      "xTerm": -0.0177,
      "constant": 2.03,
      "distArray": [
        208.72, 241.1, 273.83
      ],
      "powerArray": [80, 90, 100]
    },
    "2w": {
      "eleEffectPos": 0.728,
      "eleEffectNeg": 0.55,
      "eleVarPos": 1.012,
      "eleVarNeg": 1.014,
      "eleInfPos": 3,
      "eleInfNeg": 2,
      "eleWindFactPos": 1,
      "eleWindFactNeg": 1.25,
      "windFactorPos": 3.9,
      "windFactorNeg": 5,
      "windDistFactPos": 0.017,
      "windDistFactNeg": 0.019,
      "xSquared": 0.0000412,
      "xTerm": -0.00946,
      "constant": 0.849,
      "distArray": [
        208.72, 241.1, 273.83
      ],
      "powerArray": [80, 90, 100]
    },
    "3w": {
      "eleEffectPos": 0.63,
      "eleEffectNeg": 0.627,
      "eleVarPos": 1.014,
      "eleVarNeg": 1.013,
      "eleInfPos": 4.5,
      "eleInfNeg": 2,
      "eleWindFactPos": 0.98,
      "eleWindFactNeg": 1.3,
      "windFactorPos": 2.75,
      "windFactorNeg": 2.95,
      "windDistFactPos": 0.017,
      "windDistFactNeg": 0.019,
      "xSquared": 0.0000465,
      "xTerm": -0.0102,
      "constant": 0.868,
      "distArray": [
        187.5, 213.15, 240.75
      ],
      "powerArray": [80, 90, 100]
    }
  }
  "dunk": {
    "1w": {
      "eleEffectPos": 0.737,
      "eleEffectNeg": 0.632,
      "eleVarPos": 1.012,
      "eleVarNeg": 1.013,
      "eleInfPos": 2.7,
      "eleInfNeg": 4.25,
      "eleWindFactPos": 1,
      "eleWindFactNeg": 1.25,
      "windFactorPos": 3,
      "windFactorNeg": 6.25,
      "windDistFactPos": 0.016,
      "windDistFactNeg": 0.015,
      "xSquared": 0.000014,
      "xTerm": 0.00289,
      "constant": -0.667,
      "distArray": [
        162, 192.15, 224.88, 259.05
      ],
      "powerArray": [70, 80, 90, 100]
    },
    "2w": {
      "eleEffectPos": 0.662,
      "eleEffectNeg": 0.63,
      "eleVarPos": 1.013,
      "eleVarNeg": 1.012,
      "eleInfPos": 2.7,
      "eleInfNeg": 4.25,
      "eleWindFactPos": 1,
      "eleWindFactNeg": 1.23,
      "windFactorPos": 3.2,
      "windFactorNeg": 6.25,
      "windDistFactPos": 0.016,
      "windDistFactNeg": 0.015,
      "xSquared": 0.0000724,
      "xTerm": -0.0189,
      "constant": 1.83,
      "distArray": [
        155.28, 182.5, 211.72, 242.12
      ],
      "powerArray": [70, 80, 90, 100]
    },
    "3w": {
      "eleEffectPos": 0.668,
      "eleEffectNeg": 0.58,
      "eleVarPos": 1.01,
      "eleVarNeg": 1.011,
      "eleInfPos": 2.1,
      "eleInfNeg": 4.25,
      "eleWindFactPos": 0.98,
      "eleWindFactNeg": 1.25,
      "windFactorPos": 3,
      "windFactorNeg": 6.25,
      "windDistFactPos": 0.016,
      "windDistFactNeg": 0.015,
      "xSquared": 0.0000486,
      "xTerm": -0.00914,
      "constant": 0.747,
      "distArray": [
        146.55, 170.82, 197.5, 225.35
      ],
      "powerArray": [70, 80, 90, 100]
    }
  }
}

var shotCalc = function (pinDist, elevation, windSpeed, windAngle, ballEffect, ballBreaks, greenInc, shotType, club) {
 
	let currShot = shotData.shotType.club
	
	//Distance addition due to ball effect
	var terrainDist = shotData.shotType.terrainEffect["70"] + pinDistance;
	var hWindVector = windSpeed * Math.sin(windAngle * Math.PI / 180); 
	var vWindVector = windSpeed * Math.cos(windAngle * Math.Pi / 180);
	
	//find starting horizontal wind distance 
	var hwi = xSquared**2 + xTerm + constant;
	
	//find the max power from hwi table for next calculation
	var lastVal = currShot.distArray.length - 1
	
	//find the change in elevation effect due to reduction of max shot distance
	if (elevation > 0) {
		var eleFactor = currShot.eleEffectPos*Math.pow(currShot.eleVarPos,currShot.distArray[lastVal]-terrainDist);
	} else {
		var eleFactor = currShot.eleEffectNeg*Math.pow(currShot.eleVarNeg,currShot.distArray[lastVal]-terrainDist);
	}
	
	//shot specific elevation factored into total elevation
	var eleActual = eleFactor * elevation;
	//influence due to the total force of the wind on shot aim
	var windInfluence = hWindVector * hwi;
	
	//calculate effect of wind on shot distance based on head or tailwind and calculate final pin distance
	if (windAngle<=90) {
		var windDist = vWindVector*hwi*currShot.eleWindFactPos*(1-(eleActual*currShot.windDistFactPos));
		var percentWindEffect = (100+(windDist*windFactorPos/-4))/100;
		var finalPinDist = terrainDist+eleActual-windDist;
	} else {
		var windDist = vWindVector*hwi*currShot.eleWindFactNeg*(1-(eleActual*currShot.windDistFactNeg);
		var percentWindEffect = (100+(windDist*4/-windFactorNeg))/100;
		var finalPinDist = terrainDist+eleActual-windDist;
	}
	
	//effect of slope on horizontal aiming
	var slopeEffect = hwi / 4 * ballBreaks;		
	
	//total elevation influence on shot distance
	if (elevation>=0) {						
		var eleInfTotal = (100+(eleActual/-eleInfPos))/100;	
	} else {
		var eleinfTotal = (100+(eleActual/-eleInfNeg))/100;
	}
	
	var finalHWI = hwi * hWindVector * eleInfTotal;
	if(windAngle<=90) {
		var horizontalUnits = finalHWI * percentWindEffect + slopeEffect;
	} else {
		var horizontalUnits = finalHWI / percentWindEffect + slopeEffect;
	}
	
	//create array for shot% and power
	var 
	
	//calculate final shot distance adjustments
	var shotPower = interpolateArray(currShot.distArray, powerArray, finalPinDist);
	var caliperDist = shotPower / 100 * maxShotPower;
	
	//convert horizontal unit measurement to power bar measurement
	var pbDist = Math.mod(horizontalUnits,1.92)/0.217; 
	
	//this section calculates spin for dunk shots and provides recommended spins
	//for tomahawks and backspin shots
	if (shotType = 'dunk') {
		var normal1 = Math.mod(shotPower, 30/108);
		var normal2 = normal1 / (30/108);
		if (normal2 < 0.288) {
			var normal3 = Math.floor(normal2);
		} else {
			var normal3 = Math.ceil(normal2);
		}
		
		if (normal1 > (30/108) - 0.08) {
			var spinVariant = 9;
		} else {
			var spinVariant = 8;
		}
		
		if (normal1 < 0.08) {
			var spinActual = 9;
		} else {
			var spinActual = spinVariant;
		}
	} else if (shotType = 'tomahawk') {
		var spinActual = 7;
	} else {
		var spinActual = 9;
	}
	
	//return object containing all of the shot information to be displayed
	return {
		shotPower: shotPower,
		caliperDist: caliperDist,
		pbDist: pbDist,
		spinActual: spinActual
	};
};


//Function that interpolates a table that is passed to it within two arrays
var interpolateArray = function(xArray, yArray, newX) {
	var arrayLength = xArray.length;
	var y1, y2, x1, x2, i, lowBounds;
	
	for (i = 0; i < arrayLength; i++) {
		if (xArray[i] < newX) {
			lowBounds = i;
		}
	}
	
	x1 = xArray[i];
	y1 = yArray[i];
	x2 = xArray[i+1];
	y2 = yArray[i+1];
	
	var newY = y1 + (newX - x1)*(y2-y1)/(x2-x1); 

	return newY;
};

function appendResult(text) {
  document.getElementById('result').innerHTML += text;
}
